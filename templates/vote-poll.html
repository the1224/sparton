<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta property="og:title" content="개발자 소통 게시판 회원가입"/>
    <meta property="og:description" content="같이 소통하는 공간입니다. "/>
    <meta property="og:image" content="https://cdn.pixabay.com/photo/2015/01/08/18/27/startup-593341_960_720.jpg"/>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>

    <title>투표개최화면</title>

    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@200;300;400;500;600;700;900&display=swap"
          rel="stylesheet">
    <style>
        * {
            font-family: 'Ubuntu', sans-serif;

        }
        .box {
            width: 50%;
            margin: auto;
        }
        .mygroup > * {
            margin: 0px 0px 10px 0px;
        }
        .mygroup > .mytext {
            font-size: 20px;
            border: 1px black;
        }
        .mygroup2 > * {
            margin: 0px 0px 10px 0px;
        }
        .mygroup2 > .mytext {
            font-size: 20px;
            border: 1px black;
        }
        .mybutton {
            float: right;
            margin-left: 10px;
            display: block;
        }
        button {
            margin-left: 10px;
        }

    </style>
    <script>
        function addResponse() {
            let temp_html =
                `<div class="input-group">
                           <input type="text" class="form-control" aria-label="Dollar amount (with dot and two decimal places)">
                        </div>`
            $('#myvote').append(temp_html)
        }
        function startPoll(){
            let title = $('#title').val()
            let res1 = $('#res1').val()
            let res2 = $('#res2').val()
            if (res1==res2) {
                alert('response값이 중복됩니다. 다시 입력해 주세요!')
            }
            else {
                $.ajax({
                type: 'POST',
                url: '/api/vote-poll',
                data: {title_give:title, res1_give:res1, res2_give:res2},
                success: function (response) {
                    alert('투표 생성 완료!')

                    {# 투표 생성 완료시, 다른 사람들도 링크로 참여할 수 있는 공유 링크가 있는 페이지로 redirect#}
                    {# GET parameter로 id 값을 넘겨줌 #}
                    window.location = '/shared-vote-links?' + 'id' + '=' + response['id']
                    return false;
                }
            });
            }

        }
    </script>

</head>
<body>
<h1>vote-poll page</h1>

<div class="box">
    <div class="mygroup">
        <h2>Create a new Poll</h2>
        <div class="mygroup2" id="myvote">
            <div class="mytext">Question</div>
            <div class="input-group" class="myinput">
                <input id="title" type="text" class="form-control"
                       aria-label="Dollar amount (with dot and two decimal places)">
            </div>
            <div class="mytext">Responses (Minimum 2)</div>
            <div class="input-group" class="myinput">
                <input id="res1" type="text" class="form-control" aria-label="Dollar amount (with dot and two decimal places)">
            </div>
            <div class="input-group">
                <input id="res2" type="text" class="form-control" aria-label="Dollar amount (with dot and two decimal places)">
            </div>
        </div>
        <div class="mybutton">
            <button onclick="addResponse()" type="button" class="btn btn-outline-primary" style="float: right;">
                Add
            </button>
        </div>
        <div class="mybutton">
            <button type="button" class="btn btn-light">Cancle</button>
            <button onclick="startPoll()" type="button" class="btn btn-primary">Start Poll</button>
        </div>
    </div>
</div>
</body>

</html>